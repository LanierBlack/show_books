function start(e){function n(){o.removeClass("hide")}function t(){o.addClass("hide")}var o=e("#dialog");t(),e("form").submit(n),e("a").click(n),e(".flashWrapper").delay(3e3).fadeOut(500),e(".navSwitcher").click(function(){var n=e(".navSwitcher"),t=e(".nav"),o=t.css("top");t.stop(!0,!0),0===o||"0px"===o?(t.animate({top:"-"+t.css("height")},300),n.find("span").css("backgroundColor","#222222")):(t.animate({top:0},300),n.find("span").css("backgroundColor","#FFFFFF"))}),e(".removeBook").click(function(){var o=e(this).parent().parent();confirm("确认删除?")&&(n(),e.post("/book",{_method:"delete",username:window.location.href.split("/").reverse()[0],bookId:e(this).parent().find(".bookId").val(),name:o.find(".name").html(),author:o.find(".author").html(),commentId:null},function(e){e.success&&(o.remove(),t())}))}),e(".commentContent").each(function(){e(this).html(markdown.toHTML(e(this).html().replace(/\n|\r|\r\n/g,"\n\n")))}),e(".removeComment").click(function(){var o=e(this).parent();confirm("确认删除?")&&(n(),e.post("/comment",{_method:"delete",name:decodeURI(window.location.href.split("/").reverse()[0]),commentId:o.find(".commentId").val()},function(e){e.success&&(o.remove(),t())}))}),e(".createCommentBtn").click(function(){var e=window.location.href;window.location.href=e.replace("comment","editcomment")}),e("textarea[name=comment]").bind("paste cut keydown keyup focus blur",function(){e(".wordNumber").html(e(this).val().replace(/\n|\r|\r\n/g,"").length),e(".preview").html(markdown.toHTML(e(this).val().replace(/\n|\r|\r\n/g,"\n\n")))}),e(".changeUserInfoBtn").click(function(){e(".changeUserInfoForm").toggleClass("hide"),e(".changeUserPswordForm").addClass("hide")}),e(".changeUserPswordBtn").click(function(){e(".changeUserPswordForm").toggleClass("hide"),e(".changeUserInfoForm").addClass("hide")});var a=e(".userHeadFile");e(".userHeadImg").click(function(){a&&a.click()}),a&&a.on("change",function(n){var t=new FileReader,o=n.target.files[0];return!(0!==o.type.indexOf("image")||!o.type||!/\.(?:jpg|png|gif)$/.test(o.name))&&(t.readAsDataURL(o),void(t.onload=function(n){var t=n.target.result;e.post("/profile",{head:t}),e(".userHeadImg").attr("src",t)}))})}define(["jquery"],function(e){start(e)});